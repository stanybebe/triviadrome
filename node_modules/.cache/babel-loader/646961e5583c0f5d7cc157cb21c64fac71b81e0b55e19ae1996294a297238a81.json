{"ast":null,"code":"import _toConsumableArray from\"/Users/mac/Documents/GitHub/triviadrome/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/mac/Documents/GitHub/triviadrome/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{io}from'socket.io-client';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Admin(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),messages=_useState2[0],setMessages=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),messagesOut=_useState4[0],setMessagesOut=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),allOut=_useState6[0],setAllOut=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),selectedUser=_useState8[0],setSelectedUser=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),joinedUsers=_useState10[0],setJoinedUsers=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),selectedUserId=_useState12[0],setSelectedUserId=_useState12[1];var sockets=io('http://192.168.0.7:3001');useEffect(function(){console.log(allOut);var socket=io('http://192.168.0.7:3001');socket.emit('getJoinedUsers');socket.on('joinedUsers',function(users){var uniqueUsernames=new Set();var filteredUsers=users.filter(function(user){if(!uniqueUsernames.has(user.username)&&user.username){uniqueUsernames.add(user.username);return true;}return false;});setJoinedUsers(filteredUsers);});socket.on('adminMessage',function(data){console.log('Received message:',data);var userId=data.userId,message=data.message;console.log(data);// Check the type of userId and message\nconsole.log(typeof data.userId,typeof data.message);// Update the messages state with the new message\nvar newMessageUser={sender:data.userId,username:data.userId,content:data.message};setMessages(function(prevMessages){return[].concat(_toConsumableArray(prevMessages),[{userId:userId,message:message}]);});setAllOut(function(prevMessages){return[].concat(_toConsumableArray(prevMessages),[newMessageUser]);});});return function(){socket.disconnect();};},[]);var handleUserSelect=function handleUserSelect(user,userId){setSelectedUser(user);setSelectedUserId(userId);};var handleMessageChange=function handleMessageChange(event){setMessagesOut(event.target.value);};// Handle sending message to the selected user\nvar handleSendMessage=function handleSendMessage(){if(selectedUser){sockets.emit('adminMessageOut',{id:selectedUserId,username:selectedUser,messagesOut:messagesOut});setMessagesOut('');}var newMessageAdmin={sender:'Admin',username:selectedUser,content:messagesOut};setAllOut(function(prevMessages){return[].concat(_toConsumableArray(prevMessages),[newMessageAdmin]);});};return/*#__PURE__*/_jsxs(\"div\",{className:\"flex\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-1/4 bg-gray-200 p-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl mb-4\",children:\"Joined Users\"}),/*#__PURE__*/_jsx(\"ul\",{children:joinedUsers.map(function(user){return/*#__PURE__*/_jsx(\"li\",{className:\"cursor-pointer p-2 mb-2 \".concat(user.username===selectedUser?'bg-blue-500 text-white':'bg-white'),onClick:function onClick(){return handleUserSelect(user.username);},children:user.username},user.id);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 p-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl mb-4\",children:\"Chat\"}),selectedUser?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"text-lg mb-2\",children:[\"Selected User: \",selectedUser]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white p-4 h-80 overflow-y-auto\",children:allOut.map(function(admes,index){if(admes.username===selectedUser){return/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsxs(\"strong\",{children:[admes.sender,\" \"]}),admes.content]},index);}return null;// Add this line to skip rendering admin messages that don't match the selected user\n})}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:messagesOut,onChange:handleMessageChange,className:\"p-2 border rounded mr-2\",placeholder:\"Enter your message\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSendMessage,className:\"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600\",children:\"Send Message\"})]})]}):/*#__PURE__*/_jsx(\"p\",{children:\"No user selected.\"})]})]});}export default Admin;","map":{"version":3,"names":["React","useState","useEffect","io","jsx","_jsx","jsxs","_jsxs","Admin","_useState","_useState2","_slicedToArray","messages","setMessages","_useState3","_useState4","messagesOut","setMessagesOut","_useState5","_useState6","allOut","setAllOut","_useState7","_useState8","selectedUser","setSelectedUser","_useState9","_useState10","joinedUsers","setJoinedUsers","_useState11","_useState12","selectedUserId","setSelectedUserId","sockets","console","log","socket","emit","on","users","uniqueUsernames","Set","filteredUsers","filter","user","has","username","add","data","userId","message","newMessageUser","sender","content","prevMessages","concat","_toConsumableArray","disconnect","handleUserSelect","handleMessageChange","event","target","value","handleSendMessage","id","newMessageAdmin","className","children","map","onClick","admes","index","type","onChange","placeholder"],"sources":["/Users/mac/Documents/GitHub/triviadrome/src/pages/Admin.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { io } from 'socket.io-client';\n\nfunction Admin() {\n  const [messages, setMessages] = useState([]);\n  const [messagesOut, setMessagesOut] = useState([]);\n  const [allOut, setAllOut] = useState([]);\n  const [selectedUser, setSelectedUser] = useState('');\n  const [joinedUsers, setJoinedUsers] = useState([]);\n  const [selectedUserId, setSelectedUserId] = useState('');\n\n  const sockets = io('http://192.168.0.7:3001');\n\n\n  useEffect(() => {\n    console.log(allOut);\n    const socket = io('http://192.168.0.7:3001');\n    socket.emit('getJoinedUsers');\n    \nsocket.on('joinedUsers', (users) => {\n  const uniqueUsernames = new Set();\n  const filteredUsers = users.filter((user) => {\n    if (!uniqueUsernames.has(user.username) && user.username) {\n      uniqueUsernames.add(user.username);\n      return true;\n    }\n    return false;\n  });\n  setJoinedUsers(filteredUsers);\n});\n\n       socket.on('adminMessage', (data) => {\n      console.log('Received message:', data);\n      const { userId, message } = data;\n      console.log(data);\n      // Check the type of userId and message\n      console.log(typeof data.userId, typeof data.message);\n      // Update the messages state with the new message\n      const newMessageUser = {\n        sender: data.userId,\n        username: data.userId,\n        content: data.message,\n      };\n\n      setMessages((prevMessages) => [...prevMessages, { userId, message }]);\n      setAllOut((prevMessages) => [...prevMessages, newMessageUser]);\n\n    });\n\n    return () => {\n      socket.disconnect();\n    };\n  }, []);\n\n  const handleUserSelect = (user,userId) => {\n    setSelectedUser(user);\n    setSelectedUserId(userId);\n  };\n\n  const handleMessageChange = (event) => {\n    setMessagesOut(event.target.value);\n  };\n\n    // Handle sending message to the selected user\n    const handleSendMessage = () => {\n  \n      if (selectedUser){\n \n       \n        sockets.emit('adminMessageOut', { id: selectedUserId, username: selectedUser, messagesOut });\n        setMessagesOut('');\n    \n      }\n\n      const newMessageAdmin = {\n        sender: 'Admin',\n        username: selectedUser,\n        content: messagesOut,\n      };\n\n      setAllOut((prevMessages) => [...prevMessages, newMessageAdmin]);\n    };\n\n  return (\n    <div className=\"flex\">\n      <div className=\"w-1/4 bg-gray-200 p-4\">\n        <h3 className=\"text-xl mb-4\">Joined Users</h3>\n        <ul>\n          {joinedUsers.map((user) => (\n            <li\n              key={user.id}\n              className={`cursor-pointer p-2 mb-2 ${\n                user.username === selectedUser ? 'bg-blue-500 text-white' : 'bg-white'\n              }`}\n              onClick={() => handleUserSelect(user.username)}\n            >\n              {user.username}\n            </li>\n          ))}\n        </ul>\n      </div>\n\n      <div className=\"flex-1 p-4\">\n        <h3 className=\"text-xl mb-4\">Chat</h3>\n        {selectedUser ? (\n          <div>\n            <h4 className=\"text-lg mb-2\">Selected User: {selectedUser}</h4>\n            <div className=\"bg-white p-4 h-80 overflow-y-auto\">\n\n\n\n     {allOut.map((admes, index) => {\n  if (admes.username === selectedUser) {\n    return (\n      <div key={index} className=\"mb-2\">\n        <strong>{admes.sender} </strong>\n        {admes.content}\n      </div>\n    );\n  }\n  return null; // Add this line to skip rendering admin messages that don't match the selected user\n})}\n\n              \n\n                 \n            </div>\n            <div className=\"mt-4\">\n              <input\n                type=\"text\"\n                value={messagesOut}\n                onChange={handleMessageChange}\n                className=\"p-2 border rounded mr-2\"\n                placeholder=\"Enter your message\"\n              />\n              <button\n                onClick={handleSendMessage}\n                className=\"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600\"\n              >\n                Send Message\n              </button>\n            </div>\n          </div>\n        ) : (\n          <p>No user selected.</p>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default Admin;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}